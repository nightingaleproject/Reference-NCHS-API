name: Update swagger

on:
  push:
    branches: [ swagger-page ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-dotnet@v1
    - name: Install dependencies
      run: dotnet tool restore
    - name: Run Swagger Generation Scripts
      working-directory: build
      run: |
        dotnet swagger tofile --output /swagger/v1/swagger.yaml --yaml /messaging/bin/Debug/net6.0/messaging.dll v1 WorkingDirectory=/messaging
        dotnet swagger tofile --output /swagger/v1/swagger.json /messaging/bin/Debug/net6.0/messaging.dll v1 WorkingDirectory=/messaging
    - name: Set up git config
      run: |
        git config user.name "GitHub Actions Swagger Docs Bot"
        git config user.email "<>"
    - name: commit changes
      run: |
        git checkout "${GITHUB_REF:11}"
        git add ./swagger/v1/swagger.yaml
        git add ./swagger/v1/swagger.json
        git commit -m "Swagger Bot - Update Swagger Documentation."
        git push
        